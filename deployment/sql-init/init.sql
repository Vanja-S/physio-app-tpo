-- DATABASE USER
DROP USER if exists 'fizioUser'@'%' ;
CREATE USER 'fizioUser'@'%' IDENTIFIED BY 'fizioUser';
GRANT ALL PRIVILEGES ON * . * TO 'fizioUser'@'%';

-- KEYCLOAK USER
DROP USER if exists 'keycloakUser'@'%' ;
CREATE USER 'keycloakUser'@'%' IDENTIFIED BY 'keycloakUser';
GRANT ALL PRIVILEGES ON * . * TO 'keycloakUser'@'%';

CREATE DATABASE fizio;
CREATE DATABASE keycloak;
USE fizio;

DROP TABLE IF EXISTS VNOS;
DROP TABLE IF EXISTS VAJA;
DROP TABLE IF EXISTS FIZIOPLAN;
DROP TABLE IF EXISTS OBVESTILO;
DROP TABLE IF EXISTS TERMIN;
DROP TABLE IF EXISTS PACIENT;
DROP TABLE IF EXISTS FIZIOTERAPEVT;


/*==============================================================*/
/* Table: FIZIOPLAN                                             */
/*==============================================================*/
CREATE TABLE FIZIOPLAN
(
   ID_FIZIOPLANA        INT NOT NULL AUTO_INCREMENT,
   USERNAME_PACIENTA    VARCHAR(100) NOT NULL,
   NASLOV_FIZIOPLANA    VARCHAR(150),
   POSKODBA             VARCHAR(100),
   TRAJANJE_OD          DATE,
   TRAJANJE_DO          DATE,
   OPIS_FIZIOPLANA      VARCHAR(5000),
   PRIMARY KEY (ID_FIZIOPLANA)
);

/*==============================================================*/
/* Table: FIZIOTERAPEVT                                         */
/*==============================================================*/
CREATE TABLE FIZIOTERAPEVT
(
   USERNAME_FIZIOTERAPEVTA VARCHAR(100) NOT NULL,
   IME_FIZIOTERAPEVTA   VARCHAR(100),
   PRIIMEK_FIZIOTERAPEVTA VARCHAR(100),
   ULICA                VARCHAR(50),
   HISNA_STEVILKA       VARCHAR(10),
   POSTNA_STEVILKA      INT,
   KRAJ                 VARCHAR(50),
   PRIMARY KEY (USERNAME_FIZIOTERAPEVTA)
);

/*==============================================================*/
/* Table: OBVESTILO                                             */
/*==============================================================*/
CREATE TABLE OBVESTILO
(
   ID_OBVESTILA         INT NOT NULL AUTO_INCREMENT,
   ID_TERMINA           INT NOT NULL,
   NASLOV_OBVESTILA     VARCHAR(150) NOT NULL,
   TS                   TIMESTAMP,
   VSEBINA              VARCHAR(150),
   PRIMARY KEY (ID_OBVESTILA)
);

/*==============================================================*/
/* Table: PACIENT                                               */
/*==============================================================*/
CREATE TABLE PACIENT
(
   USERNAME_PACIENTA    VARCHAR(100) NOT NULL,
   USERNAME_FIZIOTERAPEVTA VARCHAR(100) NOT NULL,
   IME_PACIENTA         VARCHAR(100),
   PRIIMEK_PACIENTA     VARCHAR(100),
   DATUM_ROJSTVA        DATE,
   PRIMARY KEY (USERNAME_PACIENTA)
);

/*==============================================================*/
/* Table: TERMIN                                               */
/*==============================================================*/
CREATE TABLE TERMIN
(
   ID_TERMINA           INT NOT NULL AUTO_INCREMENT,
   USERNAME_PACIENTA    VARCHAR(100),
   USERNAME_FIZIOTERAPEVTA VARCHAR(100) NOT NULL,
   ZACETEK              DATETIME,
   KONEC                DATETIME,
   JE_ZASEDEN           BOOL DEFAULT FALSE,
   PRIMARY KEY (ID_TERMINA)
);

/*==============================================================*/
/* Table: VAJA                                                  */
/*==============================================================*/
CREATE TABLE VAJA
(
   ID_VAJE              INT NOT NULL AUTO_INCREMENT,
   IME_VAJE             VARCHAR(100),
   OPIS_VAJE            VARCHAR(5000),
   URL                  VARCHAR(500),
   PRIMARY KEY (ID_VAJE)
);

/*==============================================================*/
/* Table: VNOS                                                  */
/*==============================================================*/
CREATE TABLE VNOS
(
   ID_VNOSA             INT NOT NULL AUTO_INCREMENT,
   ID_VAJE              INT NOT NULL,
   ID_FIZIOPLANA        INT NOT NULL,
   ST_SETOV             INT,
   ST_PONOVITEV         INT,
   KOMENTAR             VARCHAR(5000),
   PRIMARY KEY (ID_VNOSA)
);

ALTER TABLE FIZIOPLAN ADD CONSTRAINT FK_FIZIOPLAN_USERNAME_PACIENTA FOREIGN KEY (USERNAME_PACIENTA)
      REFERENCES PACIENT (USERNAME_PACIENTA) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE OBVESTILO ADD CONSTRAINT FK_OBVESTILO_ID_TERMINA FOREIGN KEY (ID_TERMINA)
      REFERENCES TERMIN (ID_TERMINA) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE PACIENT ADD CONSTRAINT FK_PACIENT_USERNAME_FIZIOTERAPEVTA FOREIGN KEY (USERNAME_FIZIOTERAPEVTA)
      REFERENCES FIZIOTERAPEVT (USERNAME_FIZIOTERAPEVTA) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE TERMIN ADD CONSTRAINT FK_TERMIN_USERNAME_PACIENTA FOREIGN KEY (USERNAME_PACIENTA)
      REFERENCES PACIENT (USERNAME_PACIENTA) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE TERMIN ADD CONSTRAINT FK_TERMIN_USERNAME_FIZIOTERAPEVTA FOREIGN KEY (USERNAME_FIZIOTERAPEVTA)
      REFERENCES FIZIOTERAPEVT (USERNAME_FIZIOTERAPEVTA) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE VNOS ADD CONSTRAINT FK_VNOS_ID_VAJE FOREIGN KEY (ID_VAJE)
      REFERENCES VAJA (ID_VAJE) ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE VNOS ADD CONSTRAINT FK_VNOS_ID_FIZIOPLANA FOREIGN KEY (ID_FIZIOPLANA)
      REFERENCES FIZIOPLAN (ID_FIZIOPLANA) ON DELETE CASCADE ON UPDATE CASCADE;

-- FIZIOTERAPEVT
INSERT INTO FIZIOTERAPEVT (USERNAME_FIZIOTERAPEVTA, IME_FIZIOTERAPEVTA, PRIIMEK_FIZIOTERAPEVTA, ULICA, HISNA_STEVILKA, POSTNA_STEVILKA, KRAJ) VALUES ('mg7954', 'Meghan', 'Gamble', 'West Eritrea Way', '375', '09344', 'Benton Harbor');
INSERT INTO FIZIOTERAPEVT (USERNAME_FIZIOTERAPEVTA, IME_FIZIOTERAPEVTA, PRIIMEK_FIZIOTERAPEVTA, ULICA, HISNA_STEVILKA, POSTNA_STEVILKA, KRAJ) VALUES ('wn2649', 'Walter', 'Nolan', 'North Elmira Ln.', '71121', '47355', 'Bridgeport');
INSERT INTO FIZIOTERAPEVT (USERNAME_FIZIOTERAPEVTA, IME_FIZIOTERAPEVTA, PRIIMEK_FIZIOTERAPEVTA, ULICA, HISNA_STEVILKA, POSTNA_STEVILKA, KRAJ) VALUES ('cl0375', 'Chadwick', 'Lamb', 'South Gilette Ct.', '90858', '18560', 'Pierre');

-- PACIENT
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('wy4833', 'mg7954', 'Warren', 'Zamora', '1999-2-12');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('is0186', 'wn2649', 'Isaiah', 'Saunders', '1982-6-8');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('ar5211', 'cl0375', 'Aladdin', 'Ruiz', '1989-5-22');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('vm8830', 'mg7954', 'Vernon', 'Mueller', '1974-10-28');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('bm4862', 'wn2649', 'Brandon', 'Mueller', '2001-10-16');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('rd8252', 'mg7954', 'Randall', 'Duffy', '1971-5-22');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('gc6420', 'cl0375', 'Giacomo', 'Chandler', '1994-3-6');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('br8621', 'mg7954', 'Beck', 'Rios', '1985-3-8');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('df6329', 'mg7954', 'Davis', 'Ford', '1987-11-2');
INSERT INTO PACIENT (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, IME_PACIENTA, PRIIMEK_PACIENTA, DATUM_ROJSTVA) VALUES ('lr9814', 'wn2649', 'Lucas', 'Rush', '1989-12-28');

-- TERMIN
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'mg7954', '2024-1-15 07:00:00', '2024-1-15 08:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('is0186', 'wn2649', '2024-1-20 12:00:00', '2024-1-20 13:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'wn2649', '2024-1-25 11:0:00', '2024-1-25 12:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('bm4862', 'mg7954', '2024-1-30 09:00:00', '2024-1-30 10:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-2-4 08:00:00', '2024-2-4 09:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('df6329', 'cl0375', '2024-2-9 07:00:00', '2024-2-9 08:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'mg7954', '2024-2-14 15:00:00', '2024-2-14 16:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'wn2649', '2024-2-19 09:00:00', '2024-2-19 10:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('ar5211', 'mg7954', '2024-2-24 13:00:00', '2024-2-24 14:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-2-29 07:00:00', '2024-2-29 08:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('wy4833', 'wn2649', '2024-3-5 08:00:00', '2024-3-5 09:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'mg7954', '2024-3-10 09:00:00', '2024-3-10 10:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('lr9814', 'cl0375', '2024-3-15 11:00:00', '2024-3-15 12:00:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'mg7954', '2024-3-20 13:00:00', '2024-3-20 14:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-3-25 11:00:00', '2024-3-25 12:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-3-30 12:00:00', '2024-3-30 13:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-4-4 13:00:00', '2024-4-4 14:00:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES ('gc6420', 'wn2649', '2024-4-9 13:30:00', '2024-4-9 14:30:00', '1');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'mg7954', '2024-4-14 14:15:00', '2024-4-14 15:15:00', '0');
INSERT INTO TERMIN (USERNAME_PACIENTA, USERNAME_FIZIOTERAPEVTA, ZACETEK, KONEC, JE_ZASEDEN) VALUES (NULL, 'cl0375', '2024-4-19 15:00:00', '2024-4-19 16:00:00', '0');

-- VAJA
INSERT INTO VAJA (IME_VAJE, OPIS_VAJE, URL) VALUES ('Bird dog', 'Get on your hands and knees', 'jKNjWVsnOLgrs1G');
INSERT INTO VAJA (IME_VAJE, OPIS_VAJE, URL) VALUES ('Stretching wrist flexors', 'Hold the palm of one hand with the other hand while keeping your elbow straight on the affected arm. Now pull your hand back gently to feel a stretch in the forearm.', 'ZtkBQ3wfZ5jGE4c');
INSERT INTO VAJA (IME_VAJE, OPIS_VAJE, URL) VALUES ('Extension lunge', 'Stand up with your feet together and take a step forward with the good leg. The affected leg must stay planted on the ground with the heel down. Return to the starting position and repeat.', 'FY8vWg6VqycAVhr');
INSERT INTO VAJA (IME_VAJE, OPIS_VAJE, URL) VALUES ('Standing soleus stretching', 'Stand and place both hands on a wall, with your feet about half a meter from the wall. Place one leg behind the other and slowly bend the knees while keeping the heels on the floor until you feel a stretch in the calf of the back leg. Maintain the stretch and relax.', 'JaTyMe4FpU0ruDd');
INSERT INTO VAJA (IME_VAJE, OPIS_VAJE, URL) VALUES ('Left side head bending', 'In a sitting or standing position, bend your head to the left as far as possible. Think about putting your ear on top of your shoulder, without any elevation of the shoulder. Modify the amount of chin retraction (tucking your chin) in order to centralize the pain.', 'PPrvBAXZW9bMl1y');


-- FIZIOPLAN
INSERT INTO FIZIOPLAN (USERNAME_PACIENTA, NASLOV_FIZIOPLANA, POSKODBA, TRAJANJE_OD, TRAJANJE_DO, OPIS_FIZIOPLANA) VALUES ('is0186','Naslov1','Poskodba1','2024-1-19','2024-4-19','Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in');
INSERT INTO FIZIOPLAN (USERNAME_PACIENTA, NASLOV_FIZIOPLANA, POSKODBA, TRAJANJE_OD, TRAJANJE_DO, OPIS_FIZIOPLANA) VALUES ('bm4862','Naslov2','Poskodba2','2024-2-22','2024-3-22','Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in');
INSERT INTO FIZIOPLAN (USERNAME_PACIENTA, NASLOV_FIZIOPLANA, POSKODBA, TRAJANJE_OD, TRAJANJE_DO, OPIS_FIZIOPLANA) VALUES ('df6329','Naslov3','Poskodba3','2024-1-7','2024-2-7','Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in');

-- VNOS
INSERT INTO VNOS (ID_VAJE, ID_FIZIOPLANA, ST_SETOV, ST_PONOVITEV) VALUES (1, 1, 3, 12);
INSERT INTO VNOS (ID_VAJE, ID_FIZIOPLANA, ST_SETOV, ST_PONOVITEV) VALUES (2, 1, 3, 12);
INSERT INTO VNOS (ID_VAJE, ID_FIZIOPLANA, ST_SETOV, ST_PONOVITEV) VALUES (3, 1, 3, 12);

-- OBVESTILO
INSERT INTO OBVESTILO (ID_TERMINA, NASLOV_OBVESTILA, TS, VSEBINA) VALUES (2, 'Naročeni ste na pregled', '2023-12-10 15:10:10', 'Naročeni ste na pregled dne 20. 1. 2024 ob 12:00 pri dr. Walter Nolan.');
INSERT INTO OBVESTILO (ID_TERMINA, NASLOV_OBVESTILA, TS, VSEBINA) VALUES (4, 'Pregled preklican', '2023-12-7 16:20:10', 'Naročeni ste na pregled dne 30. 1. 2024 ob 9:00 pri dr. Meghan Gamble.');



